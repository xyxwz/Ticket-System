/**
 * Timeago is a jQuery plugin that makes it easy to support automatically
 * updating fuzzy timestamps (e.g. "4 minutes ago" or "about 1 day ago").
 *
 * @name timeago
 * @version 0.10.0
 * @requires jQuery v1.2.3+
 * @author Ryan McGeary
 * @license MIT License - http://www.opensource.org/licenses/mit-license.php
 *
 * For usage and examples, visit:
 * http://timeago.yarp.com/
 *
 * Copyright (c) 2008-2011, Ryan McGeary (ryanonjavascript -[at]- mcgeary [*dot*] org)
 */
/*!
 * jQuery UI @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
/*!
 * jQuery UI Widget @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
/*!
 * jQuery UI Mouse @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
((function(){function A(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(w.isFunction(a.isEqual))return a.isEqual(b);if(w.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return!1;switch(d){case"[object String]":return String(a)==String(b);case"[object Number]":return a=+a,b=+b,a!=a?b!=b:a==0?1/a==1/b:a==b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&A(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(j.call(a,h)){f++;if(!(g=j.call(b,h)&&A(a[h],b[h],c)))break}if(g){for(h in b)if(j.call(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new C(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=w),exports._=w):typeof define=="function"&&define.amd?define("underscore",[],function(){return w}):a._=w,w.VERSION="1.2.2";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(j.call(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=c!==void 0;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=w.bind(b,d)),e?a.reduce(b,c):a.reduce(b);x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=w.bind(b,d)),c!==void 0?a.reduceRight(b,c):a.reduceRight(b);var e=(w.isArray(a)?a.slice():w.toArray(a)).reverse();return w.reduce(e,b,c,d)},w.find=w.detect=function(a,b,c){var d;return y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},w.filter=w.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},w.reject=function(a,b,c){var d=[];return a==null?d:(x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},w.every=w.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var y=w.some=w.any=function(a,b,d){b=b||w.identity;var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(x(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};w.include=w.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(c=y(a,function(a){return a===b}),c)},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a))return Math.max.apply(Math,a);if(!b&&w.isEmpty(a))return-Infinity;var d={computed:-Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},w.min=function(a,b,c){if(!b&&w.isArray(a))return Math.min.apply(Math,a);if(!b&&w.isEmpty(a))return Infinity;var d={computed:Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},w.shuffle=function(a){var b=[],c;return x(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},w.sortBy=function(a,b,c){return w.pluck(w.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={},d=w.isFunction(b)?b:function(a){return a[b]};return x(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?a.toArray?a.toArray():w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):w.values(a):[]},w.size=function(a){return w.toArray(a).length},w.first=w.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},w.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a,b){return w.reduce(a,function(a,c){return w.isArray(c)?a.concat(b?c:w.flatten(c)):(a[a.length]=c,a)},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b,c){var d=c?w.map(a,c):a,e=[];return w.reduce(d,function(c,d,f){if(0==f||(b===!0?w.last(c)!=d:!w.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a,b){return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=w.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var z=function(){};w.bind=function(b,c){var d,e;if(b.bind===v&&v)return v.apply(b,g.call(arguments,1));if(!w.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){z.prototype=b.prototype;var a=new z,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)}),a},w.memoize=function(a,b){var c={};return b||(b=w.identity),function(){var d=b.apply(this,arguments);return j.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))},w.throttle=function(a,b){var c,d,e,f,g,h=w.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},w.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},w.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments));return b.apply(this,c)}},w.compose=function(){var a=g.call(arguments);return function(){var b=g.call(arguments);for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)j.call(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){return x(g.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])}),a},w.defaults=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},w.clone=function(a){return w.isObject(a)?w.isArray(a)?a.slice():w.extend({},a):a},w.tap=function(a,b){return b(a),a},w.isEqual=function(a,b){return A(a,b,[])},w.isEmpty=function(a){if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(j.call(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)=="[object Array]"},w.isObject=function(a){return a===Object(a)},i.call(arguments)=="[object Arguments]"?w.isArguments=function(a){return i.call(a)=="[object Arguments]"}:w.isArguments=function(a){return!!a&&!!j.call(a,"callee")},w.isFunction=function(a){return i.call(a)=="[object Function]"},w.isString=function(a){return i.call(a)=="[object String]"},w.isNumber=function(a){return i.call(a)=="[object Number]"},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},w.isDate=function(a){return i.call(a)=="[object Date]"},w.isRegExp=function(a){return i.call(a)=="[object RegExp]"},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.noConflict=function(){return a._=b,this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.mixin=function(a){x(w.functions(a),function(b){E(b,w[b]=a[b])})};var B=0;w.uniqueId=function(a){var b=B++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},w.template=function(a,b){var c=w.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,w):function(a){return e(a,w)}};var C=function(a){this._wrapped=a};w.prototype=C.prototype;var D=function(a,b){return b?w(a).chain():a},E=function(a,b){C.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),D(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];C.prototype[a]=function(){return b.apply(this._wrapped,arguments),D(this._wrapped,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];C.prototype[a]=function(){return D(b.apply(this._wrapped,arguments),this._chain)}}),C.prototype.chain=function(){return this._chain=!0,this},C.prototype.value=function(){return this._wrapped}})).call(this),function(a,b){typeof exports!="undefined"?b(a,exports,require("underscore")):typeof define=="function"&&define.amd?define("backbone",["underscore","jquery","exports"],function(c,d,e){b(a,e,c,d)}):a.Backbone=b(a,{},a._,a.jQuery||a.Zepto||a.ender)}(this,function(a,b,c,d){var e=a.Backbone,f=Array.prototype.slice;b.VERSION="0.5.3",b.noConflict=function(){return a.Backbone=e,b},b.emulateHTTP=!1,b.emulateJSON=!1,b.Events={bind:function(a,b,c){var d=this._callbacks||(this._callbacks={}),e=d[a]||(d[a]={}),f=e.tail||(e.tail=e.next={});return f.callback=b,f.context=c,e.tail=f.next={},this},unbind:function(a,b){var c,d,e;if(!a)this._callbacks=null;else if(c=this._callbacks)if(!b)c[a]={};else if(d=c[a])while((e=d)&&(d=d.next)){if(d.callback!==b)continue;e.next=d.next,d.context=d.callback=null;break}return this},trigger:function(a){var b,c,d,e,g,h=["all",a];if(!(c=this._callbacks))return this;while(g=h.pop()){if(!(b=c[g]))continue;e=g=="all"?arguments:f.call(arguments,1);while(b=b.next)(d=b.callback)&&d.apply(b.context||this,e)}return this}},b.Model=function(a,b){var d;a||(a={}),b&&b.parse&&(a=this.parse(a));if(d=t(this,"defaults"))a=c.extend({},d,a);this.attributes={},this._escapedAttributes={},this.cid=c.uniqueId("c"),this.set(a,{silent:!0}),this._changed=!1,this._previousAttributes=c.clone(this.attributes),b&&b.collection&&(this.collection=b.collection),this.initialize(a,b)},c.extend(b.Model.prototype,b.Events,{_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return c.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var d=this.attributes[a];return this._escapedAttributes[a]=c.escape(d==null?"":""+d)},has:function(a){return this.attributes[a]!=null},set:function(a,b,d){var e;c.isObject(a)||a==null?(e=a,d=b):(e={},e[a]=b),d||(d={});if(!e)return this;e.attributes&&(e=e.attributes);if(d.unset)for(var f in e)e[f]=void 0;var g=this.attributes,h=this._escapedAttributes;if(!d.silent&&this.validate&&!this._performValidation(e,d))return!1;this.idAttribute in e&&(this.id=e[this.idAttribute]);var i=this._changing;this._changing=!0;for(var f in e){var j=e[f];if(!c.isEqual(g[f],j)||d.unset&&f in g)d.unset?delete g[f]:g[f]=j,delete h[f],this._changed=!0,d.silent||this.trigger("change:"+f,this,j,d)}return i||(!d.silent&&this._changed&&this.change(d),this._changing=!1),this},unset:function(a,b){return(b||(b={})).unset=!0,this.set(a,null,b)},clear:function(a){return(a||(a={})).unset=!0,this.set(c.clone(this.attributes),a)},fetch:function(a){a||(a={});var c=this,d=a.success;return a.success=function(b,e,f){if(!c.set(c.parse(b,f),a))return!1;d&&d(c,b)},a.error=v(a.error,c,a),(this.sync||b.sync).call(this,"read",this,a)},save:function(a,c){c||(c={});if(a&&!this.set(a,c))return!1;var d=this,e=c.success;c.success=function(a,b,f){if(!d.set(d.parse(a,f),c))return!1;e&&e(d,a,f)},c.error=v(c.error,d,c);var f=this.isNew()?"create":"update";return(this.sync||b.sync).call(this,f,this,c)},destroy:function(a){a||(a={});if(this.isNew())return this.trigger("destroy",this,this.collection,a);var c=this,d=a.success;return a.success=function(b){c.trigger("destroy",c,c.collection,a),d&&d(c,b)},a.error=v(a.error,c,a),(this.sync||b.sync).call(this,"delete",this,a)},url:function(){var a=t(this.collection,"url")||this.urlRoot||u();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(a){this.trigger("change",this,a),this._previousAttributes=c.clone(this.attributes),this._changed=!1},hasChanged:function(a){return a?this._previousAttributes[a]!=this.attributes[a]:this._changed},changedAttributes:function(a){if(!this._changed)return!1;a||(a=this.attributes);var b=!1,d=this._previousAttributes;for(var e in a){if(c.isEqual(d[e],a[e]))continue;(b||(b={}))[e]=a[e]}for(var e in d)e in a||((b||(b={}))[e]=void 0);return b},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return c.clone(this._previousAttributes)},_performValidation:function(a,b){var c=this.validate(a,b);return c?(b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}}),b.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator),c.bindAll(this,"_onModelEvent","_removeReference"),this._reset(),a&&this.reset(a,{silent:!0}),this.initialize.apply(this,arguments)},c.extend(b.Collection.prototype,b.Events,{model:b.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){if(c.isArray(a))for(var d=0,e=a.length;d<e;d++)b&&b.at==+b.at&&d&&(b.at+=1),this._add(a[d],b);else this._add(a,b);return this},remove:function(a,b){if(c.isArray(a))for(var d=0,e=a.length;d<e;d++)this._remove(a[d],b);else this._remove(a,b);return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return this.models=this.sortBy(this.comparator),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return c.map(this.models,function(b){return b.get(a)})},reset:function(a,b){return a||(a=[]),b||(b={}),this.each(this._removeReference),this._reset(),this.add(a,{silent:!0,parse:b.parse}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a||(a={}),a.parse===undefined&&(a.parse=!0);var c=this,d=a.success;return a.success=function(b,e,f){c[a.add?"add":"reset"](c.parse(b,f),a),d&&d(c,b)},a.error=v(a.error,c,a),(this.sync||b.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var d=b.success;return b.success=function(a,e,f){c.add(a,b),d&&d(a,e,f)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return c(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,c){if(a instanceof b.Model)a.collection||(a.collection=this);else{var d=a;a=new this.model(d,{collection:this,parse:c.parse}),a.validate&&!a._performValidation(a.attributes,c)&&(a=!1)}return a},_add:function(a,b){b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var c=this.getByCid(a);if(c)throw new Error(["Can't add the same model to a set twice",c.id]);this._byId[a.id]=a,this._byCid[a.cid]=a;var d=b.at!=null?b.at:this.comparator?this.sortedIndex(a,this.comparator):this.length;return this.models.splice(d,0,a),a.bind("all",this._onModelEvent),this.length++,b.index=d,b.silent||a.trigger("add",a,this,b),a},_remove:function(a,b){b||(b={}),a=this.getByCid(a)||this.get(a);if(!a)return null;delete this._byId[a.id],delete this._byCid[a.cid];var c=this.indexOf(a);return this.models.splice(c,1),this.length--,b.index=c,b.silent||a.trigger("remove",a,this,b),this._removeReference(a),a},_removeReference:function(a){this==a.collection&&delete a.collection,a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this._remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var g=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"];c.each(g,function(a){b.Collection.prototype[a]=function(){return c[a].apply(c,[this.models].concat(c.toArray(arguments)))}}),b.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var h=/:\w+/g,i=/\*\w+/g,j=/[-[\]{}()+?.,\\^$|#\s]/g;c.extend(b.Router.prototype,b.Events,{initialize:function(){},route:function(a,d,e){b.history||(b.history=new b.History),c.isRegExp(a)||(a=this._routeToRegExp(a)),b.history.route(a,c.bind(function(b){var c=this._extractParameters(a,b);e&&e.apply(this,c),this.trigger.apply(this,["route:"+d].concat(c))},this))},navigate:function(a,c){b.history.navigate(a,c)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(j,"\\$&").replace(h,"([^/]*)").replace(i,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),b.History=function(){this.handlers=[],c.bindAll(this,"checkUrl")};var k=/^#/,l=/msie [\w.]+/,m=!1;c.extend(b.History.prototype,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c)}else a=window.location.hash;return a=decodeURIComponent(a.replace(k,"")),a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a},start:function(a){if(m)throw new Error("Backbone.history has already been started");this.options=c.extend({},{root:"/"},this.options,a),this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var b=this.getFragment(),e=document.documentMode,f=l.exec(navigator.userAgent.toLowerCase())&&(!e||e<=7);f&&(this.iframe=d('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?d(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!f?d(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval),this.fragment=b,m=!0;var g=window.location,h=g.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&g.hash&&(this.fragment=g.hash.replace(k,""),window.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a),d=c.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return d},navigate:function(a,b){if(!b||b===!0)b={trigger:b};var c=(a||"").replace(k,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;this._hasPushState?(c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))),b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}}),b.View=function(a){this.cid=c.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.delegateEvents(),this.initialize.apply(this,arguments)};var n=/^(\S+)\s*(.*)$/,o=["model","collection","el","id","attributes","className","tagName"];c.extend(b.View.prototype,b.Events,{tagName:"div",$:function(a){return a==null?d(this.el):d(a,this.el)},initialize:function(){},render:function(){return this},remove:function(){return d(this.el).remove(),this},make:function(a,b,c){var e=document.createElement(a);return b&&d(e).attr(b),c&&d(e).html(c),e},delegateEvents:function(a){if(!a&&!(a=t(this,"events")))return;this.undelegateEvents();for(var b in a){var e=this[a[b]];if(!e)throw new Error('Event "'+a[b]+'" does not exist');var f=b.match(n),g=f[1],h=f[2];e=c.bind(e,this),g+=".delegateEvents"+this.cid,h===""?d(this.el).bind(g,e):d(this.el).delegate(h,g,e)}},undelegateEvents:function(){d(this.el).unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=c.extend({},this.options,a));for(var b=0,d=o.length;b<d;b++){var e=o[b];a[e]&&(this[e]=a[e])}this.options=a},_ensureElement:function(){if(!this.el){var a=this.attributes||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.el=this.make(this.tagName,a)}else c.isString(this.el)&&(this.el=d(this.el).get(0))}});var p=function(a,b){var c=s(this,a,b);return c.extend=this.extend,c};b.Model.extend=b.Collection.extend=b.Router.extend=b.View.extend=p;var q={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};b.sync=function(a,e,f){var g=q[a],h={type:g,dataType:"json"};return f.url||(h.url=t(e,"url")||u()),!f.data&&e&&(a=="create"||a=="update")&&(h.contentType="application/json",h.data=JSON.stringify(e.toJSON())),b.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),b.emulateHTTP&&(g==="PUT"||g==="DELETE")&&(b.emulateJSON&&(h.data._method=g),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",g)}),h.type!=="GET"&&!b.emulateJSON&&(h.processData=!1),d.ajax(c.extend(h,f))};var r=function(){},s=function(a,b,d){var e;return b&&b.hasOwnProperty("constructor")?e=b.constructor:e=function(){return a.apply(this,arguments)},c.extend(e,a),r.prototype=a.prototype,e.prototype=new r,b&&c.extend(e.prototype,b),d&&c.extend(e,d),e.prototype.constructor=e,e.__super__=a.prototype,e},t=function(a,b){return!a||!a[b]?null:c.isFunction(a[b])?a[b]():a[b]},u=function(){throw new Error('A "url" property or function must be specified')},v=function(a,b,c){return function(d,e){var e=d===b?e:d;a?a(d,e,c):b.trigger("error",d,e,c)}};return b}),define("BaseView",["jquery","underscore","backbone"],function(a,b,c){var d=function(a){this.bindings=[],this.views=[],this.intervals=[],c.View.apply(this,[a])};return b.extend(d.prototype,c.View.prototype,{createView:function(a,b){var c=new a(b);return this.views.push(c),c},createInterval:function(a,b){var c=setInterval(b,a);this.intervals.push(c)},bindTo:function(a,b,c){a.bind(b,c),this.bindings.push({model:a,ev:b,callback:c})},unbindFromAll:function(){b.each(this.bindings,function(a){a.model.unbind(a.ev,a.callback)}),this.bindings=[]},trash:function(a){a.unbindFromAll(),a.unbind(),a.remove()},dispose:function(){var a=this;a.trash(this),b.each(this.views,function(c){a.trash(c),c.views.length>0&&b.each(c.views,function(b){a.trash(b)})}),this.views=[],b.each(this.intervals,function(a){clearInterval(a)}),this.intervals=[]}}),d.extend=c.View.extend,d}),define("models/Comment",["underscore","backbone"],function(a,b){var c=b.Model.extend({initialize:function(){},validate:function(a){if(typeof a.comment!="undefined"&&!a.comment.replace(/ /g,"").length)return"Comment must have content to post."},updateComment:function(a,b){a&&this.set({comment:a}),this.save(null,{error:b})}});return c}),define("collections/Comments",["underscore","backbone","models/Comment"],function(a,b,c){var d=b.Collection.extend({model:c,initialize:function(){this.comparator=function(a){return a.get("created_at")}},removeComments:function(a){var b=this;this.each(function(b){b.destroy({error:a})})}});return d}),define("models/Ticket",["underscore","backbone","collections/Comments"],function(a,b,c){var d=b.Model.extend({defaults:{status:"Open"},urlRoot:"/api/tickets",initialize:function(){var b=this;a.bindAll(this),this.comments=new c,this.comments.url="/api/tickets/"+this.id+"/comments",this.bind("change",function(){b.comments.url="/api/tickets/"+this.id+"/comments"}),this.get("status")==="open"&&(this.bind("assignedUser",this.collection.setMyTickets),this.bind("unassignedUser",this.collection.setMyTickets))},validate:function(a){if(typeof a.title!="undefined"&&!a.title.replace(/ /g,"").length)return"You must enter a ticket title.";if(typeof a.description!="undefined"&&!a.description.replace(/ /g,"").length)return"You must enter a ticket description."},updateTicket:function(a,b){a.title&&this.set({title:a.title}),a.description&&this.set({description:a.description}),a.status&&this.set({status:a.status}),this.save(null,{error:b})},close:function(a){var b=this;this.save({status:"closed"},{error:a,success:function(){b.unbind("assignedUser",b.collection.setMyTickets),b.unbind("unassignedUser",b.collection.setMyTickets),ticketer.collections.openTickets.remove(b),ticketer.collections.closedTickets.add(b)}})},assignUser:function(b,c){var d=a.clone(this.get("assigned_to"));d.push(b),this.set({assigned_to:a.uniq(d)},{silent:!0}),this.trigger("assignedUser",this),this.save(null,{error:c})},unassignUser:function(b,c){var d=a.clone(this.get("assigned_to")),e=a.reject(d,function(a){return a===b});this.set({assigned_to:a.uniq(e)},{silent:!0}),this.trigger("unassignedUser",this),this.save(null,{error:c})}});return d}),define("collections/Tickets",["underscore","backbone","models/Ticket"],function(a,b,c){var d=b.Collection.extend({model:c,url:"/api/tickets",initialize:function(){var b=this;a.bindAll(this),this.comparator=function(a){return a.get("opened_at")},this.page=1,this.bind("reset",this.loadAllComments),this.bind("add",this.loadComment),currentUser.role==="admin"&&(this.mine=new Array,this.bind("reset",this.setMyTickets),this.bind("add",this.setMyTickets),this.bind("remove",this.setMyTickets))},loadAllComments:function(){var a=this;this.each(function(b){a.loadComment(b)})},loadComment:function(a){a.comments.fetch()},setMyTickets:function(b){var c,d;c=this.filter(function(b){d=a.include(b.get("assigned_to"),currentUser.id);if(d)return b}),this.mine=c}});return d}),define("models/User",["underscore","backbone"],function(a,b){var c=b.Model.extend({url:"/api/users",initialize:function(){}});return c}),define("collections/Users",["underscore","backbone","models/User"],function(a,b,c){var d=b.Collection.extend({model:c,initialize:function(){this.comparator=function(a){return a.get("name")}}});return d}),define("AppView",["jquery","underscore","backbone"],function(a,b,c){function d(){this.showView=function(b,c){var d=this;this.currentView&&this.currentView.dispose(),this.currentError&&this.currentError.dispose(),this.currentView=b,this.currentView.render(),a("#main").fadeOut(200,function(){a(this).html(d.currentView.el)}).fadeIn(200,c)},this.showHeader=function(b,c){var d=this,e;c||(c={status:"closed"});if(this.currentHeader&&this.headerView){if(this.headerView!=b){a(this.currentHeader.el).fadeOut(200,function(){d.currentHeader.dispose(),d.headerView=null,d.currentHeader=new b,d.headerView=b,e=d.currentHeader.render().el,a(e).hide(),c.tab&&d.toggleHeaderTab(c.tab),c.status&&d.currentHeader.toggleAssign(c.status),a("#tabs .container").append(e),a(e).fadeIn(200)});return}c.tab&&d.toggleHeaderTab(c.tab),c.status&&d.currentHeader.toggleAssign(c.status)}else this.currentHeader=new b({admin:!0}),this.headerView=b,e=this.currentHeader.render().el,a(e).hide(),c.tab&&this.toggleHeaderTab(c.tab),c.status&&this.currentHeader.toggleAssign(c.status),a("#tabs .container").append(e),a(e).fadeIn(200)},this.toggleHeaderTab=function(a){typeof a!="undefined"&&typeof this.currentHeader.toggleTab=="function"&&(this.currentHeader.toggleTab(a),this.currentHeader.toggleAssign(a))},this.showError=function(b,c){var d=this;this.currentError&&this.currentError.dispose(),this.currentError=new b({message:c}),this.currentError.render(),a(this.currentError.el).hide(),a("body").prepend(this.currentError.el),a(this.currentError.el).slideDown(200,function(){function c(){a(b).slideUp(200,function(){d.currentError.dispose()})}var b=this;setTimeout(function(){c()},4e3)})}}return d}),define("timeline",["jquery","backbone"],function(a,b){var c=function(){function b(a,b,c,d,e){var f,g,h,i,j;f=this,this.collection=a,this.render=b,this.el=d,this.args=e,this.elements={wrapper:c,firstItem:c.find(this.el+":first-child"),lastItem:c.find(this.el+":last-child")},this.shouldCheckScroll=!1,this.didScroll=this.didScroll}return b.prototype.infiniteScrollThreshold=175,b.prototype.permalinkScrollThreshold=200,b.prototype.laterItemsPossible=!0,b.prototype.receivedData=function(a){var b,c,d,e,f,g;e=function(){var d,e,f;f=[];for(d=0,e=a.length;d<e;d++)g=a[d],b=this.collection.get(g.id),c=this.render(b),f.push(this.elements.wrapper.append(c));return f}.call(this),this.elements.lastItem=this.elements.wrapper.find(this.el+":last-child"),this.elements.firstItem=this.elements.wrapper.find(this.el+":first-child")},b.prototype.didScroll=function(){var b,c,d,e,f,g,h,i,j,k,l,m;b=this;if(!this.shouldCheckScroll)return;this.shouldCheckScroll=!1,i=a(document).scrollTop()+a(window).height(),f=this.elements.firstItem.offset().top,c=this.elements.lastItem.outerHeight()+this.elements.lastItem.offset().top,this.laterItemsPossible&&c-i<this.infiniteScrollThreshold&&(h=this.collection.page+1,this.collection.fetch({add:!0,data:{page:h,status:this.args.status},success:function(a,c){c.length!=0&&(b.collection.page=h),b.receivedData(c)}}))},b}();return c});var Mustache=function(){var a={},b=function(){};return b.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(a,b,c,d){d||(this.context=b,this.buffer=[]);if(!this.includes("",a)){if(d)return a;this.send(a);return}a=this.render_pragmas(a);var e=this.render_section(a,b,c);e===!1&&(e=this.render_tags(a,b,c,d));if(d)return e;this.sendLines(e)},send:function(a){a!==""&&this.buffer.push(a)},sendLines:function(a){if(a){var b=a.split("\n");for(var c=0;c<b.length;c++)this.send(b[c])}},render_pragmas:function(a){if(!this.includes("%",a))return a;var b=this,c=this.getCachedRegex("render_pragmas",function(a,b){return new RegExp(a+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+b,"g")});return a.replace(c,function(a,c,d){if(!b.pragmas_implemented[c])throw{message:"This implementation of mustache doesn't understand the '"+c+"' pragma"};b.pragmas[c]={};if(d){var e=d.split("=");b.pragmas[c][e[0]]=e[1]}return""})},render_partial:function(a,b,c){a=this.trim(a);if(!c||c[a]===undefined)throw{message:"unknown_partial '"+a+"'"};return typeof b[a]!="object"?this.render(c[a],b,c,!0):this.render(c[a],b[a],c,!0)},render_section:function(a,b,c){if(!this.includes("#",a)&&!this.includes("^",a))return!1;var d=this,e=this.getCachedRegex("render_section",function(a,b){return new RegExp("^([\\s\\S]*?)"+a+"(\\^|\\#)\\s*(.+)\\s*"+b+"\n*([\\s\\S]*?)"+a+"\\/\\s*\\3\\s*"+b+"\\s*([\\s\\S]*)$","g")});return a.replace(e,function(a,e,f,g,h,i){var j=e?d.render_tags(e,b,c,!0):"",k=i?d.render(i,b,c,!0):"",l,m=d.find(g,b);return f==="^"?!m||d.is_array(m)&&m.length===0?l=d.render(h,b,c,!0):l="":f==="#"&&(d.is_array(m)?l=d.map(m,function(a){return d.render(h,d.create_context(a),c,!0)}).join(""):d.is_object(m)?l=d.render(h,d.create_context(m),c,!0):typeof m=="function"?l=m.call(b,h,function(a){return d.render(a,b,c,!0)}):m?l=d.render(h,b,c,!0):l=""),j+l+k})},render_tags:function(a,b,c,d){var e=this,f=function(){return e.getCachedRegex("render_tags",function(a,b){return new RegExp(a+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+b+"+","g")})},g=f(),h=function(a,d,h){switch(d){case"!":return"";case"=":return e.set_delimiters(h),g=f(),"";case">":return e.render_partial(h,b,c);case"{":return e.find(h,b);default:return e.escape(e.find(h,b))}},i=a.split("\n");for(var j=0;j<i.length;j++)i[j]=i[j].replace(g,h,this),d||this.send(i[j]);if(d)return i.join("\n")},set_delimiters:function(a){var b=a.split(" ");this.otag=this.escape_regex(b[0]),this.ctag=this.escape_regex(b[1])},escape_regex:function(a){if(!arguments.callee.sRE){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+b.join("|\\")+")","g")}return a.replace(arguments.callee.sRE,"\\$1")},find:function(a,b){function c(a){return a===!1||a===0||a}a=this.trim(a);var d;if(a.match(/([a-z_]+)\./ig)){var e=this.walk_context(a,b);c(e)&&(d=e)}else c(b[a])?d=b[a]:c(this.context[a])&&(d=this.context[a]);return typeof d=="function"?d.apply(b):d!==undefined?d:""},walk_context:function(a,b){var c=a.split("."),d=b[c[0]]!=undefined?b:this.context,e=d[c.shift()];while(e!=undefined&&c.length>0)d=e,e=e[c.shift()];return typeof e=="function"?e.apply(d):e},includes:function(a,b){return b.indexOf(this.otag+a)!=-1},escape:function(a){return a=String(a===null?"":a),a.replace(/&(?!\w+;)|["'<>\\]/g,function(a){switch(a){case"&":return"&amp;";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return a}})},create_context:function(a){if(this.is_object(a))return a;var b=".";this.pragmas["IMPLICIT-ITERATOR"]&&(b=this.pragmas["IMPLICIT-ITERATOR"].iterator);var c={};return c[b]=a,c},is_object:function(a){return a&&typeof a=="object"},is_array:function(a){return Object.prototype.toString.call(a)==="[object Array]"},trim:function(a){return a.replace(/^\s*|\s*$/g,"")},map:function(a,b){if(typeof a.map=="function")return a.map(b);var c=[],d=a.length;for(var e=0;e<d;e++)c.push(b(a[e]));return c},getCachedRegex:function(b,c){var d=a[this.otag];d||(d=a[this.otag]={});var e=d[this.ctag];e||(e=d[this.ctag]={});var f=e[b];return f||(f=e[b]=c(this.otag,this.ctag)),f}},{name:"mustache.js",version:"0.4.0-dev",to_html:function(a,c,d,e){var f=new b;e&&(f.send=e),f.render(a,c||{},d);if(!e)return f.buffer.join("\n")}}}();define("mustache",function(){}),function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d=typeof location!="undefined"&&location.href,e=d&&location.protocol&&location.protocol.replace(/\:/,""),f=d&&location.hostname,g=d&&(location.port||void 0),h=[];define("text",[],function(){var l,m,s;return typeof window!="undefined"&&window.navigator&&window.document?m=function(a,b){var c=l.createXhr();c.open("GET",a,!0),c.onreadystatechange=function(){c.readyState===4&&b(c.responseText)},c.send(null)}:typeof process!="undefined"&&process.versions&&process.versions.node?(s=require.nodeRequire("fs"),m=function(a,b){b(s.readFileSync(a,"utf8"))}):typeof Packages!="undefined"&&(m=function(a,b){var c=new java.io.File(a),d=java.lang.System.getProperty("line.separator"),c=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(c),"utf-8")),e,f,g="";try{e=new java.lang.StringBuffer,(f=c.readLine())&&f.length()&&f.charAt(0)===65279&&(f=f.substring(1));for(e.append(f);(f=c.readLine())!==null;)e.append(d),e.append(f);g=String(e.toString())}finally{c.close()}b(g)}),l={version:"1.0.2",strip:function(a){if(a){var a=a.replace(b,""),d=a.match(c);d&&(a=d[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var b,c,d;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(c=0;c<3;c++){d=a[c];try{b=new ActiveXObject(d)}catch(e){}if(b){a=[d];break}}if(!b)throw Error("createXhr(): XMLHttpRequest not available");return b},get:m,parseName:function(a){var b=!1,c=a.indexOf("."),d=a.substring(0,c),a=a.substring(c+1,a.length),c=a.indexOf("!");return c!==-1&&(b=a.substring(c+1,a.length),b=b==="strip",a=a.substring(0,c)),{moduleName:d,ext:a,strip:b}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,b,c,d){var e=l.xdRegExp.exec(a),f;return e?(a=e[2],e=e[3],e=e.split(":"),f=e[1],e=e[0],(!a||a===b)&&(!e||e===c)&&(!f&&!e||f===d)):!0},finishLoad:function(a,b,c,d,e){c=b?l.strip(c):c,e.isBuild&&(h[a]=c),d(c)},load:function(a,b,c,h){if(h.isBuild&&!h.inlineText)c();else{var j=l.parseName(a),k=j.moduleName+"."+j.ext,m=b.toUrl(k),n=h&&h.text&&h.text.useXhr||l.useXhr;!d||n(m,e,f,g)?l.get(m,function(b){l.finishLoad(a,j.strip,b,c,h)}):b([k],function(a){l.finishLoad(j.moduleName+"."+j.ext,j.strip,a,c,h)})}},write:function(a,b,c){if(b in h){var d=l.jsEscape(h[b]);c.asModule(a+"!"+b,"define(function () { return '"+d+"';});\n")}},writeFile:function(a,b,c,d,e){var b=l.parseName(b),f=b.moduleName+"."+b.ext,g=c.toUrl(b.moduleName+"."+b.ext)+".js";l.load(f,c,function(){var b=function(a){return d(g,a)};b.asModule=function(a,b){return d.asModule(a,g,b)},l.write(a,f,b,e)},e)}}})}(),define("text!templates/tickets/Ticket.html",[],function(){return'<!-- Ticket Creator\'s Avatar -->\n<div class="two columns avatar clearfix">\n  <a class="right shadow paper" href="#">\n    <span class="tape"></span>\n    <img src="{{user.avatar}}" alt="{{user.name}}">\n    <span class="written">{{user.shortname}}</span>\n  </a>\n</div>\n\n<!-- Ticket Body -->\n<div class="ten columns ticketInfo shadow paper">\n  <!-- Ticket Header -->\n  <div class="ticketHeader written clearfix">\n    <span class="tack"></span>\n\n    <!-- Ticket Title -->\n    <div class="ticketName left">\n      <h2>{{title}}</h2>\n    </div>\n\n    <!-- Ticket Assigned To -->\n    <ul class="right clearfix">\n    </ul>\n  </div> <!-- end of ticketHeader -->\n\n  <!-- Ticket Body -->\n  <div class="ticketBody written md">\n    {{{description}}}\n  </div> <!-- end of ticketBody -->\n\n  <!-- Ticket Comment Count -->\n  <ul class="ticketMeta">\n    <li class="chat written commentCount">{{comments}}</li>\n  </ul>\n\n</div> <!-- end of ticketInfo -->\n\n{{#showAdmin}}\n<!-- Admin Ticket Options -->\n<ul id="ticketOptions" class="ten columns offset-by-two written">\n  <li id="closeTicket" class="red shadow">Close Ticket</li>\n</ul>\n{{/showAdmin}}\n'}),define("text!templates/tickets/Timestamp.html",[],function(){return'<span class="timestamp"><time class="timeago" datetime="{{time}}">{{time}}</time></span>'}),define("text!templates/tickets/AssignedUser.html",[],function(){return'<li>\n  <span class="miniAvatar" data-user="{{id}}">\n    <img src="{{avatar}}" alt="{{name}}">\n  </span>\n</li>'}),define("text!templates/tickets/AdminPopupOptions.html",[],function(){return"<ul class='popupChoices written lightshadow hide'>\n  <li class='edit'>Edit Ticket</li>\n  <li class='remove'>Delete Ticket</li>\n</ul>"}),define("text!templates/tickets/EditTicket.html",[],function(){return'<div class="ticketEdit">\n  <form action="#" class="clearfix">\n  \t<div class="outerWrap">\n    \t<textarea name="description" class="written">{{description}}</textarea>\n\t  </div>\n\n    <ul class="optionButtons clearfix">\n      <li><button id="saveTicket" class="written green">Save</button></li>\n      <li><button id="cancelEdit" class="written red">Cancel</button></li>\n    </ul>\n  </form>\n</div>'}),function(a){function c(){var b=d(this);return isNaN(b.datetime)||a(this).text(e(b.datetime)),this}function d(c){c=a(c);if(!c.data("timeago")){c.data("timeago",{datetime:b.datetime(c)});var d=a.trim(c.text());d.length>0&&c.attr("title",d)}return c.data("timeago")}function e(a){return b.inWords(f(a))}function f(a){return(new Date).getTime()-a.getTime()}a.timeago=function(b){return b instanceof Date?e(b):typeof b=="string"?e(a.timeago.parse(b)):e(a.timeago.datetime(b))};var b=a.timeago;a.extend(a.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},inWords:function(b){function k(d,e){var f=a.isFunction(d)?d(e,b):d,g=c.numbers&&c.numbers[e]||e;return f.replace(/%d/i,g)}var c=this.settings.strings,d=c.prefixAgo,e=c.suffixAgo;this.settings.allowFuture&&b<0&&(d=c.prefixFromNow,e=c.suffixFromNow);var f=Math.abs(b)/1e3,g=f/60,h=g/60,i=h/24,j=i/365,l=f<45&&k(c.seconds,Math.round(f))||f<90&&k(c.minute,1)||g<45&&k(c.minutes,Math.round(g))||g<90&&k(c.hour,1)||h<24&&k(c.hours,Math.round(h))||h<48&&k(c.day,1)||i<30&&k(c.days,Math.floor(i))||i<60&&k(c.month,1)||i<365&&k(c.months,Math.floor(i/30))||j<2&&k(c.year,1)||k(c.years,Math.floor(j));return a.trim([d,l,e].join(" "))},parse:function(b){var c=a.trim(b);return c=c.replace(/\.\d\d\d+/,""),c=c.replace(/-/,"/").replace(/-/,"/"),c=c.replace(/T/," ").replace(/Z/," UTC"),c=c.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(c)},datetime:function(c){var d=a(c).get(0).tagName.toLowerCase()==="time",e=d?a(c).attr("datetime"):a(c).attr("title");return b.parse(e)}}),a.fn.timeago=function(){var a=this;a.each(c);var d=b.settings;return d.refreshMillis>0&&setInterval(function(){a.each(c)},d.refreshMillis),a},document.createElement("abbr"),document.createElement("time")}(jQuery),define("timeago",function(){}),define("jqueryui/core",["jquery"],function(a){(function(a,b){function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;return!b.href||!g||f.nodeName.toLowerCase()!=="map"?!1:(h=a("img[usemap=#"+g+"]")[0],!!h&&d(h))}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(a.ui.version)return;a.extend(a.ui,{version:"@VERSION",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function h(b,c,d,f){return a.each(e,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),f&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var e=d==="Width"?["Left","Right"]:["Top","Bottom"],f=d.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?g["inner"+d].call(this):this.each(function(){a(this).css(f,h(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return typeof b!="number"?g["outer"+d].call(this,b):this.each(function(){a(this).css(f,h(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!d||!a.element[0].parentNode)return;for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}})})(a)}),define("jqueryui/widget",["jquery"],function(a){(function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)try{a(e).triggerHandler("remove")}catch(f){}c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){return c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(b){}}),d.call(a(this),b,c)})}}a.widget=function(b,c,d){var e=b.split(".")[0],f;b=b.split(".")[1],f=e+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][f]=function(c){return!!a.data(c,b)},a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)};var g=new c;g.options=a.extend(!0,{},g.options),a[e][b].prototype=a.extend(!0,g,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},d),a.widget.bridge(b,a[e][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e=="string",g=Array.prototype.slice.call(arguments,1),h=this;return e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):e,f&&e.charAt(0)==="_"?h:(f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b)return h=f,!1}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))}),h)}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this),this.element=a(c),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var e=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c=="string"){if(d===b)return this.options[c];e={},e[c]=d}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",b),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var e=this.options[b];c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),d=d||{};if(c.originalEvent)for(var f=a.event.props.length,g;f;)g=a.event.props[--f],c[g]=c.originalEvent[g];return this.element.trigger(c,d),!(a.isFunction(e)&&e.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}})(a)}),define("jqueryui/mouse",["jquery","jqueryui/widget"],function(a){(function(a,b){var c=!1;a(document).mouseup(function(a){c=!1}),a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent"))return a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(b){if(c)return;this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=b.which==1,f=typeof this.options.cancel=="string"&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=this._mouseStart(b)!==!1;if(!this._mouseStarted)return b.preventDefault(),!0}return!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0,!0},_mouseMove:function(b){return!a.browser.msie||document.documentMode>=9||!!b.button?this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted):this._mouseUp(b)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return!0}})})(a)}),define("jqueryui/draggable",["jquery","jqueryui/core","jqueryui/mouse","jqueryui/widget"],function(a){(function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(!this.element.data("draggable"))return;return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(b),this.handle?(c.iframeFix&&a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute");if(!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b)),this.dropped&&(c=this.dropped,this.dropped=!1);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return!1;if(this.options.revert=="invalid"&&!c||this.options.revert=="valid"&&c||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var d=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){d._trigger("stop",b)!==!1&&d._clear()})}else this._trigger("stop",b)!==!1&&this._clear();return!1},_mouseUp:function(b){return this.options.iframeFix===!0&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;return a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)}),c},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):c.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo),d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[b.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:a(window).scrollLeft())+a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?0:a(window).scrollTop())+(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var c=a(b.containment),d=c[0];if(!d)return;var e=c.offset(),f=a(d).css("overflow")!="hidden";this.containment=[(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0),(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0),(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c}else b.containment.constructor==Array&&(this.containment=b.containment)},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(d[0].tagName),f=b.pageX,g=b.pageY;if(this.originalPosition){var h;if(this.containment){if(this.relative_container){var i=this.relative_container.offset();h=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else h=this.containment;b.pageX-this.offset.click.left<h[0]&&(f=h[0]+this.offset.click.left),b.pageY-this.offset.click.top<h[1]&&(g=h[1]+this.offset.click.top),b.pageX-this.offset.click.left>h[2]&&(f=h[2]+this.offset.click.left),b.pageY-this.offset.click.top>h[3]&&(g=h[3]+this.offset.click.top)}if(c.grid){var j=c.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY;g=h?j-this.offset.click.top<h[1]||j-this.offset.click.top>h[3]?j-this.offset.click.top<h[1]?j+c.grid[1]:j-c.grid[1]:j:j;var k=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX;f=h?k-this.offset.click.left<h[0]||k-this.offset.click.left>h[2]?k-this.offset.click.left<h[0]?k+c.grid[0]:k-c.grid[0]:k:k}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),b=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(a){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.extend(a.ui.draggable,{version:"@VERSION"}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,d.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("draggable"),e=this,f=function(b){var c=this.offset.click.top,d=this.offset.click.left,e=this.positionAbs.top,f=this.positionAbs.left,g=b.height,h=b.width,i=b.top,j=b.left;return a.ui.isOver(e+c,f+d,i,j,g,h)};a.each(d.sortables,function(f){this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c){var d=a("body"),e=a(this).data("draggable").options;d.css("cursor")&&(e._cursor=d.css("cursor")),d.css("cursor",e.cursor)},stop:function(b,c){var d=a(this).data("draggable").options;d._cursor&&a("body").css("cursor",d._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(b,c){var d=a(this).data("draggable");d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"&&(d.overflowOffset=d.scrollParent.offset())},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=!1;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!e.axis||e.axis!="x")d.overflowOffset.top+d.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||e.axis!="y")d.overflowOffset.left+d.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||e.axis!="x")b.pageY-a(document).scrollTop()<e.scrollSensitivity?f=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<e.scrollSensitivity&&(f=a(document).scrollTop(a(document).scrollTop()+e.scrollSpeed));if(!e.axis||e.axis!="y")b.pageX-a(document).scrollLeft()<e.scrollSensitivity?f=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<e.scrollSensitivity&&(f=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed))}f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c){var d=a(this).data("draggable"),e=d.options;d.snapElements=[],a(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!=d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,h=g+d.helperProportions.width,i=c.offset.top,j=i+d.helperProportions.height;for(var k=d.snapElements.length-1;k>=0;k--){var l=d.snapElements[k].left,m=l+d.snapElements[k].width,n=d.snapElements[k].top,o=n+d.snapElements[k].height;if(!(l-f<g&&g<m+f&&n-f<i&&i<o+f||l-f<g&&g<m+f&&n-f<j&&j<o+f||l-f<h&&h<m+f&&n-f<i&&i<o+f||l-f<h&&h<m+f&&n-f<j&&j<o+f)){d.snapElements[k].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=!1;continue}if(e.snapMode!="inner"){var p=Math.abs(n-j)<=f,q=Math.abs(o-i)<=f,r=Math.abs(l-h)<=f,s=Math.abs(m-g)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n-d.helperProportions.height,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l-d.helperProportions.width}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m}).left-d.margins.left)}var t=p||q||r||s;if(e.snapMode!="outer"){var p=Math.abs(n-i)<=f,q=Math.abs(o-j)<=f,r=Math.abs(l-g)<=f,s=Math.abs(m-h)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o-d.helperProportions.height,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m-d.helperProportions.width}).left-d.margins.left)}!d.snapElements[k].snapping&&(p||q||r||s||t)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=p||q||r||s||t}}}),a.ui.plugin.add("draggable","stack",{start:function(b,c){var d=a(this).data("draggable").options,e=a.makeArray(a(d.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(!e.length)return;var f=parseInt(e[0].style.zIndex)||0;a(e).each(function(a){this.style.zIndex=f+a}),this[0].style.zIndex=f+e.length}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(a)}),define("jqueryui/droppable",["jquery","jqueryui/core","jqueryui/widget","jqueryui/mouse","jqueryui/draggable"],function(a){(function(a,b){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,c=b.accept;this.isover=0,this.isout=1,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){var b=a.ui.ddmanager.droppables[this.options.scope];for(var c=0;c<b.length;c++)b[c]==this&&b.splice(c,1);return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"),this},_setOption:function(b,c){b=="accept"&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return;this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return;this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0])return!1;var e=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance))return e=!0,!1}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.extend(a.ui.droppable,{version:"@VERSION"}),a.ui.intersect=function(b,c,d){if(!c.offset)return!1;var e=(b.positionAbs||b.position.absolute).left,f=e+b.helperProportions.width,g=(b.positionAbs||b.position.absolute).top,h=g+b.helperProportions.height,i=c.offset.left,j=i+c.proportions.width,k=c.offset.top,l=k+c.proportions.height;switch(d){case"fit":return i<=e&&f<=j&&k<=g&&h<=l;case"intersect":return i<e+b.helperProportions.width/2&&f-b.helperProportions.width/2<j&&k<g+b.helperProportions.height/2&&h-b.helperProportions.height/2<l;case"pointer":var m=(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,n=(b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,o=a.ui.isOver(n,m,k,i,c.proportions.height,c.proportions.width);return o;case"touch":return(g>=k&&g<=l||h>=k&&h<=l||g<k&&h>l)&&(e>=i&&e<=j||f>=i&&f<=j||e<i&&f>j);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d=a.ui.ddmanager.droppables[b.options.scope]||[],e=c?c.type:null,f=(b.currentItem||b.element).find(":data(droppable)").andSelf();a:for(var g=0;g<d.length;g++){if(d[g].options.disabled||b&&!d[g].accept.call(d[g].element[0],b.currentItem||b.element))continue;for(var h=0;h<f.length;h++)if(f[h]==d[g].element[0]){d[g].proportions.height=0;continue a}d[g].visible=d[g].element.css("display")!="none";if(!d[g].visible)continue;e=="mousedown"&&d[g]._activate.call(d[g],c),d[g].offset=d[g].element.offset(),d[g].proportions={width:d[g].element[0].offsetWidth,height:d[g].element[0].offsetHeight}}},drop:function(b,c){var d=!1;return a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options)return;!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=d||this._drop.call(this,c)),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,c))}),d},dragStart:function(b,c){b.element.parents(":not(body,html)").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var d=a.ui.intersect(b,this,this.options.tolerance),e=!d&&this.isover==1?"isout":d&&this.isover==0?"isover":null;if(!e)return;var f;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");g.length&&(f=a.data(g[0],"droppable"),f.greedyChild=e=="isover"?1:0)}f&&e=="isover"&&(f.isover=0,f.isout=1,f._out.call(f,c)),this[e]=1,this[e=="isout"?"isover":"isout"]=0,this[e=="isover"?"_over":"_out"].call(this,c),f&&e=="isout"&&(f.isout=0,f.isover=1,f._over.call(f,c))})},dragStop:function(b,c){b.element.parents(":not(body,html)").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}})(a)}),function(){function l(){var a="(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b";return a}var a={newline:/^\n+/,code:/^ {4,}[^\n]*(?:\n {4,}[^\n]*|\n)*(?:\n+| *$)/,gfm_code:/^ *``` *(\w+)? *\n([^\0]+?)\s*```(?: *\n+| *$)/,hr:/^( *[\-*_]){3,} *\n+/,heading:/^ *(#{1,6}) *([^\0]+?) *#* *\n+/,lheading:/^([^\n]+)\n *(=|-){3,} *\n*/,blockquote:/^( *>[^\n]+(\n[^\n]+)*)+\n*/,list:/^( *)([*+-]|\d+\.) [^\0]+?(?:\n{2,}(?! )|\s*$)(?!\1bullet)\n*/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,paragraph:/^([^\n]+\n?(?!body))+\n*/,text:/^[^\n]+/};a.list=function(){var b=a.list.source;return b=b.replace("bullet",/(?:[*+-](?!(?: *[-*]){2,})|\d+\.)/.source),new RegExp(b)}(),a.html=function(){var b=a.html.source;return b=b.replace("comment",/<!--[^\0]*?-->/.source).replace("closed",/<(?!elements)(\w+)[^\0]+?<\/\1>/.source).replace("closing",/<\w+(?!:\/|@)\b(?:"[^"]*"|'[^']*'|[^>])*>/.source).replace("elements",l()),new RegExp(b)}(),a.paragraph=function(){var b=a.paragraph.source,c=[];return function d(b){return b=a[b]?a[b].source:b,c.push(b.replace(/(^|[^\[])\^/g,"$1")),d}("gfm_code")("hr")("heading")("lheading")("blockquote")("<(?!"+l()+")\\w+"),new RegExp(b.replace("body",c.join("|")))}(),a.lexer=function(b){var c=[],d={};return b=b.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),b=b.replace(/^ {0,3}\[([^\]]+)\]: *([^ ]+)(?: +["(]([^\n]+)[")])? *$/gm,function(a,b,c,e){return d[b.toLowerCase()]={href:c,title:e},""}),c.links=d,a.token(b,c,!0)},a.token=function(b,c,d){var b=b.replace(/^ +$/gm,""),e,f,g,h,i,j;while(b){if(f=a.newline.exec(b))b=b.substring(f[0].length),f[0].length>1&&c.push({type:"space"});if(f=a.code.exec(b)){b=b.substring(f[0].length),f=f[0].replace(/^ {4}/gm,""),c.push({type:"code",text:f.replace(/\n+$/,"")});continue}if(f=a.gfm_code.exec(b)){b=b.substring(f[0].length),c.push({type:"code",lang:f[1],text:f[2]});continue}if(f=a.heading.exec(b)){b=b.substring(f[0].length),c.push({type:"heading",depth:f[1].length,text:f[2]});continue}if(f=a.lheading.exec(b)){b=b.substring(f[0].length),c.push({type:"heading",depth:f[2]==="="?1:2,text:f[1]});continue}if(f=a.hr.exec(b)){b=b.substring(f[0].length),c.push({type:"hr"});continue}if(f=a.blockquote.exec(b)){b=b.substring(f[0].length),c.push({type:"blockquote_start"}),f=f[0].replace(/^ *>/gm,""),a.token(f,c,d),c.push({type:"blockquote_end"});continue}if(f=a.list.exec(b)){b=b.substring(f[0].length),c.push({type:"list_start",ordered:isFinite(f[2])}),e=/\n *\n *(?:[*+-]|\d+\.)/.test(f[0]),f=f[0].match(/^( *)([*+-]|\d+\.)[^\n]*(?:\n(?!\1(?:[*+-]|\d+\.))[^\n]*)*/gm),i=0,j=f.length;for(;i<j;i++)g=f[i].replace(/^ *([*+-]|\d+\.) */,""),h=/\n( +)/.exec(g),h&&(h=new RegExp("^"+h[1],"gm"),g=g.replace(h,"")),c.push({type:e?"loose_item_start":"list_item_start"}),a.token(g,c),c.push({type:"list_item_end"});c.push({type:"list_end"});continue}if(f=a.html.exec(b)){b=b.substring(f[0].length),c.push({type:"html",text:f[0]});continue}if(d&&(f=a.paragraph.exec(b))){b=b.substring(f[0].length),c.push({type:"paragraph",text:f[0]});continue}if(f=a.text.exec(b)){b=b.substring(f[0].length),c.push({type:"text",text:f[0]});continue}}return c};var b={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,gfm_autolink:/^(\w+:\/\/[^\s]+[^.,:;"')\]\s])/,tag:/^<!--[^\0]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^>])*>/,link:/^!?\[((?:\[[^\]]*\]|[^\[\]]|\[|\](?=[^[\]]*\]))*)\]\(([^\)]*)\)/,reflink:/^!?\[((?:\[[^\]]*\]|[^\[\]]|\[|\](?=[^[\]]*\]))*)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([^\0]+?)__(?!_)|^\*\*([^\0]+?)\*\*(?!\*)/,em:/^\b_([^\0]+?)_\b|^\*((?:\*\*|[^\0])+?)\*(?!\*)/,code:/^(`+)([^\0]*?[^`])\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,text:/^[^\0]+?(?=[\\<!\[_*`]|\w+:\/\/| {2,}\n|$)/};b.lexer=function(a){var e="",f=d.links,g,h,i,l;while(a){if(l=b.escape.exec(a)){a=a.substring(l[0].length),e+=l[1];continue}if(l=b.autolink.exec(a)){a=a.substring(l[0].length),l[2]==="@"?(h=l[1][6]===":"?k(l[1].substring(7)):k(l[1]),i=k("mailto:")+h):(h=j(l[1]),i=h),e+='<a href="'+i+'">'+h+"</a>";continue}if(l=b.gfm_autolink.exec(a)){a=a.substring(l[0].length),h=j(l[1]),i=h,e+='<a href="'+i+'">'+h+"</a>";continue}if(l=b.tag.exec(a)){a=a.substring(l[0].length),e+=l[0];continue}if(l=b.link.exec(a)){a=a.substring(l[0].length),h=/^\s*<?([^\s]*?)>?(?:\s+"([^\n]+)")?\s*$/.exec(l[2]);if(!h){e+=l[0][0],a=l[0].substring(1)+a;continue}g={href:h[1],title:h[2]},e+=c(l,g);continue}if((l=b.reflink.exec(a))||(l=b.nolink.exec(a))){a=a.substring(l[0].length),g=(l[2]||l[1]).replace(/\s+/g," "),g=f[g.toLowerCase()];if(!g||!g.href){e+=l[0][0],a=l[0].substring(1)+a;continue}e+=c(l,g);continue}if(l=b.strong.exec(a)){a=a.substring(l[0].length),e+="<strong>"+b.lexer(l[2]||l[1])+"</strong>";continue}if(l=b.em.exec(a)){a=a.substring(l[0].length),e+="<em>"+b.lexer(l[2]||l[1])+"</em>";continue}if(l=b.code.exec(a)){a=a.substring(l[0].length),e+="<code>"+j(l[2],!0)+"</code>";continue}if(l=b.br.exec(a)){a=a.substring(l[0].length),e+="<br>";continue}if(l=b.text.exec(a)){a=a.substring(l[0].length),e+=j(l[0]);continue}}return e};var c=function(a,c){return a[0][0]!=="!"?'<a href="'+j(c.href)+'"'+(c.title?' title="'+j(c.title)+'"':"")+">"+b.lexer(a[1])+"</a>":'<img src="'+j(c.href)+'" alt="'+j(a[1])+'"'+(c.title?' title="'+j(c.title)+'"':"")+">"},d,e,f=function(){return e=d.pop()},g=function(){switch(e.type){case"space":return"";case"hr":return"<hr>";case"heading":return"<h"+e.depth+">"+b.lexer(e.text)+"</h"+e.depth+">";case"code":return"<pre><code"+(e.lang?' class="'+e.lang+'"':"")+">"+(e.escaped?e.text:j(e.text,!0))+"</code></pre>";case"blockquote_start":var a=[];while(f().type!=="blockquote_end")a.push(g());return"<blockquote>"+a.join("")+"</blockquote>";case"list_start":var c=e.ordered?"ol":"ul",a=[];while(f().type!=="list_end")a.push(g());return"<"+c+">"+a.join("")+"</"+c+">";case"list_item_start":var a=[];while(f().type!=="list_item_end")a.push(e.type==="text"?h():g());return"<li>"+a.join(" ")+"</li>";case"loose_item_start":var a=[];while(f().type!=="list_item_end")a.push(g());return"<li>"+a.join(" ")+"</li>";case"html":return b.lexer(e.text);case"paragraph":return"<p>"+b.lexer(e.text)+"</p>";case"text":return"<p>"+h()+"</p>"}},h=function(){var a=[e.text],c;while((c=d[d.length-1])&&c.type==="text")a.push(f().text);return b.lexer(a.join("\n"))},i=function(a){d=a.reverse();var b=[];while(f())b.push(g());return d=null,e=null,b.join("\n")},j=function(a,b){return a.replace(b?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},k=function(a){var b="",c,d=0,e=a.length;for(;d<e;d++)c=a.charCodeAt(d),Math.random()>.5&&(c="x"+c.toString(16)),b+="&#"+c+";";return b},m=function(b){return i(a.lexer(b))};m.parser=i,m.lexer=a.lexer,m.parse=m,typeof module!="undefined"?module.exports=m:this.marked=m}.call(this),define("marked",function(){}),define("views/tickets/TicketView",["jquery","underscore","backbone","BaseView","mustache","text!templates/tickets/Ticket.html","text!templates/tickets/Timestamp.html","text!templates/tickets/AssignedUser.html","text!templates/tickets/AdminPopupOptions.html","text!templates/tickets/EditTicket.html","timeago","jqueryui/droppable","marked"],function(a,b,c,d,e,f,g,h,i,j){var k=d.extend({tagName:"div",className:"row ticket",events:{"click #closeTicket":"closeTicket","click .popupChoices li.remove":"deleteTicket","click .popupChoices li.edit":"editTicket","click #saveTicket":"saveTicket","click #cancelEdit":"renderEdit"},initialize:function(){b.bindAll(this),this.admin=this.options.admin,a(this.el).attr("id","id_"+this.model.id),this.assigned_to=this.model.get("assigned_to"),this.bindTo(this.model.comments,"add",this.updateCommentCount),this.bindTo(this.model.comments,"remove",this.updateCommentCount),this.bindTo(this.model.comments,"reset",this.updateCommentCount),this.bindTo(this.model,"change",this.updateTicket),this.bindTo(this.model,"assignedUser",this.addAssignee)},render:function(){var b=this,c=this.model.toJSON();return c.description=marked(c.description),c.comments=this.model.comments.length,c.showAdmin=this.renderAdminOptions(),c.user=this.model.get("user"),c.user.shortname=c.user.name.split(" ")[0],a(this.el).html(Mustache.to_html(f,c)),this.setTimestamp(),this.setAssignedUsers(),a(this.el).droppable({accept:".assign",scope:"assigned_to",drop:function(a,c){b.model.assignUser(c.draggable.attr("id"))}}),this.checkAbilities(c),this},renderAdminOptions:function(){var a=this;if(this.admin&&this.admin===!0)return ticketer.currentUser.role==="admin"&&a.model.get("status")!="closed"?!0:!1},checkAbilities:function(b){if(this.admin&&(b.user.id===currentUser.id||currentUser.role==="admin")){var c="<li class='gears'></li>";a("ul.ticketMeta",this.el).append(c),b.user.id===currentUser.id&&currentUser.role!="admin"?this.bindTo(a("ul.ticketMeta li.gears",this.el),"click",this.editTicket):(a("ul.ticketMeta li.gears",this.el).append(i),this.bindTo(a("ul.ticketMeta li.gears",this.el),"click",this.showEditOptions))}},showEditOptions:function(){a("ul.ticketMeta li.gears ul",this.el).show(),this.bindTo(a("ul.ticketMeta li.gears",this.el),"clickoutside",this.hideEditOptions)},hideEditOptions:function(){a("ul.ticketMeta li.gears ul",this.el).fadeOut(200)},deleteTicket:function(){var a;a=confirm("Are you sure you want to delete this ticket? It can not be undone"),a===!0&&(this.model.destroy(),window.history.back())},setTimestamp:function(){var b;this.model.get("closed_at")?(a(".timestamp",this.el).remove(),b={time:this.model.get("closed_at")},a(".ticketName",this.el).append(Mustache.to_html(g,b)),a(".timestamp",this.el).prepend("closed: "),a("time.timeago",this.el).timeago()):(b={time:this.model.get("opened_at")},a(".ticketName",this.el).append(Mustache.to_html(g,b)),a("time.timeago",this.el).timeago())},updateCommentCount:function(){a(".commentCount",this.el).html(this.model.comments.length)},closeTicket:function(){this.model.close(),a(this.el).droppable("destroy"),a(".ticketHeader ul",this.el).off(),a(".ticketHeader ul li",this.el).each(function(){a(this).draggable("destroy")})},updateTicket:function(b){var c=this.model.changedAttributes();c.status&&a("#ticketOptions",this.el).fadeOut(100),c.closed_at&&this.setTimestamp()},setAssignedUsers:function(){var c=this;b.each(this.model.get("assigned_to"),function(b){var d=ticketer.collections.admins.get(b),e=Mustache.to_html(h,d.toJSON());a(".ticketHeader ul",c.el).prepend(e)}),ticketer.currentUser.role==="admin"&&a(".ticketHeader ul",this.el).on("mouseenter","li",function(){a(this).is(":data(draggable)")||(a(this).draggable({distance:30,cursorAt:{top:21,left:21}}),a(".ticketHeader ul li",c.el).bind("drag",c.dragAvatar),a(".ticketHeader ul li",c.el).bind("dragstop",c.dragAvatarStop))})},addAssignee:function(c){var d=this,e=b.difference(this.model.changedAttributes().assigned_to,this.assigned_to);b.each(e,function(b){d.assigned_to.push(b);var c=ticketer.collections.admins.get(b),e=Mustache.to_html(h,c.toJSON());a(".ticketHeader ul",d.el).prepend(e)})},removeAssignee:function(a){var c=b.reject(this.assigned_to,function(b){return b===a});this.assigned_to=c,this.model.unassignUser(a)},dragAvatar:function(b,c){var d=c.helper;c.position.top<-45?(a(d).data("draggable").options.revert=!1,a("span figure",d).length===0&&a("span",d).append("<figure class='poof'></figure>")):(a(d).data("draggable").options.revert=!0,a("figure",d).remove())},dragAvatarStop:function(b,c){var d=c.helper;if(c.position.top<-45){var e=a("span",d).data("user");a(d).remove(),this.removeAssignee(e)}else a("figure",d).remove()},editTicket:function(){var b=this;a(".ticketBody > .ticketEdit",b.el).length===0&&(a("ul.ticketMeta li.gears ul",this.el).hide(),a(".ticketBody").html(Mustache.to_html(j,{description:b.model.get("description")})),a("textarea",this.el).autoResize({minHeight:150,extraSpace:14}))},saveTicket:function(b){b.preventDefault();var c=this,d=a(".outerWrap > textarea",c.el).val();c.model.save({description:d},{error:c.triggerViewError,success:c.renderEdit})},triggerViewError:function(a,b){this.trigger("view:error",b)},renderEdit:function(b){b instanceof jQuery.Event&&b.preventDefault();var c=this;a("textarea",this.el).data("AutoResizer").destroy(),a(this.el).fadeOut(200,function(){c.render(),a(c.el).fadeIn(200)})}});return k}),function(a){function c(a,b){return a.nodeType==3?e(a,b):d(a,b)}function d(b,d){var b=a(b),e=b.clone().empty(),f;return b.contents().each(function(){var a=d-e.text().length;if(a==0)return;f=c(this,a),f&&e.append(f)}),e}function e(c,d){var e=f(c.data);b&&(e=e.replace(/^ /,"")),b=!!e.match(/ $/);var e=e.slice(0,d);return e=a("<div/>").text(e).html(),e}function f(a){return a.replace(/\s+/g," ")}var b=!0;a.fn.truncate=function(b){var d=a.extend({},a.fn.truncate.defaults,b);a(this).each(function(){var b=a.trim(f(a(this).text())).length;if(b<=d.max_length)return;var e=d.max_length-d.more.length-3,g=c(this,e),h=a(this);g.insertAfter(h);var i=a("p:last-child",g).append(d.more);a(h).remove()})},a.fn.truncate.defaults={max_length:100,more:"&#8230;",less:""}}(jQuery),define("truncate",function(){}),define("views/tickets/TicketListView",["jquery","underscore","backbone","BaseView","timeline","views/tickets/TicketView","truncate"],function(a,b,c,d,e,f){var g=d.extend({events:{"click .ticketInfo":"showDetails"},initialize:function(){var a;a=this,b.bindAll(this),this.models=this.options.models,this.status=this.options.status?this.options.status:"open"},render:function(){var c=this,d;return b.each(this.models,function(b){d=c.renderTicket(b),a(c.el).append(d)}),this.status==="closed"&&this.initTimeline(),this},renderTicket:function(b){var c,d;return c=this.createView(f,{model:b}),d=c.render().el,a(".ticketInfo .ticketBody",d).truncate({max_length:500}),a(".ticketInfo",d).addClass("hover"),d},initTimeline:function(){var b=this;if(this.collection.length===0)return;this.timeline=new e(this.collection,this.renderTicket,a(this.el),".ticket",{status:this.status}),this.bindTo(a(window),"scroll",function(){b.timeline.shouldCheckScroll=!0}),this.createInterval(250,function(){b.timeline.didScroll()})},showDetails:function(b){var c=a(b.currentTarget).closest(".ticket").attr("id").split("id_")[1];ticketer.routers.ticketer.navigate("tickets/"+c,!0)}});return g}),define("text!templates/comments/Comment.html",[],function(){return'<div class="ten columns offset-by-two commentBody shadow paper clearfix">\n  <span class="tape"></span>\n\n  <!-- Comment Avatar -->\n  <div class="commentAvatar">\n    <span class="miniAvatar"><img src="{{user.avatar}}" alt="{{user.name}}"></span>\n  </div>\n\n  <!-- Comment Body -->\n  <div class="commentInfo md">\n    <h5>{{user.name}}:</h5>\n    <div>{{{comment}}}</div>\n  </div>\n\n  <!-- Timestamp -->\n  <span class="commentTime"><time class="timeago" datetime="{{created_at}}">{{created_at}}</time></span>\n\n</div> <!-- end of commentBody -->'}),define("text!templates/comments/EditComment.html",[],function(){return'<!-- Form -->\n<form action="#">\n  <div class="outerWrap">\n    <textarea class="placeholder written" name="ticket_comment">{{comment}}</textarea>\n  </div>\n\n  <ul class="optionButtons">\n    <li><button class="saveComment written green">Save</button></li>\n    <li><button class="cancelEdit written red">Cancel</button></li>\n  </ul>\n</form>\n'}),define("views/comments/CommentView",["jquery","underscore","backbone","BaseView","mustache","text!templates/comments/Comment.html","text!templates/comments/EditComment.html","timeago","marked"],function(a,b,c,d,e,f,g){var h=d.extend({tagName:"div",className:"row comment written",events:{"click li.delete":"removeComment","click li.edit":"editComment","click .saveComment":"saveComment","click .cancelEdit":"renderEdit",mouseenter:"toggleOptions",mouseleave:"toggleOptions"},initialize:function(){b.bindAll(this)},render:function(){var b;return b=this.model.toJSON(),b.comment=marked(b.comment),a(this.el).html(Mustache.to_html(f,b)),a(".commentTime time",this.el).timeago(),this.checkAbilities(b),this},checkAbilities:function(b){if(b.user.id===currentUser.id||currentUser.role==="admin"){var c="<ul class='commentOptions hide'></ul>";a(".commentBody",this.el).append(c),b.user.id===currentUser.id?(a("ul.commentOptions",this.el).append('<li class="edit"></li>'),a("ul.commentOptions",this.el).append('<li class="delete">x</li>')):a("ul.commentOptions",this.el).append('<li class="delete">x</li>')}},toggleOptions:function(){a("ul.commentOptions",this.el).length>0&&(a("ul.commentOptions",this.el).is(":visible")?a("ul.commentOptions",this.el).fadeOut("100").addClass("hide"):a("ul.commentOptions",this.el).hide().removeClass("hide").fadeIn("100"))},editComment:function(){var b=this;a(".commentBody > .commentEdit",this.el).length===0&&(a(".commentInfo",this.el).html(Mustache.to_html(g,{comment:b.model.get("comment")})),a("textarea",this.el).autoResize({minHeight:23,extraSpace:14}))},saveComment:function(b){b.preventDefault();var c=this,d=a("textarea",this.el).val();c.model.save({comment:d},{error:c.triggerViewError,success:c.renderEdit})},triggerViewError:function(a,b){this.trigger("view:error",b)},renderEdit:function(b){b instanceof jQuery.Event&&b.preventDefault();var c=this;a("textarea",this.el).data("AutoResizer").destroy(),a(this.el).fadeOut(200,function(){c.render(),a(c.el).fadeIn(200)})},removeComment:function(){var b,c=this;b=confirm("Are you sure you want to delete this comment? It can not be undone"),b===!0&&(this.model.destroy(),a(this.el).fadeOut(200,function(){c.remove()}))}});return h}),define("views/comments/CommentListView",["jquery","underscore","backbone","BaseView","views/comments/CommentView"],function(a,b,c,d,e){var f=d.extend({initialize:function(){b.bindAll(this),this.bindTo(this.collection,"add",this.addComment),this.bindTo(this.collection,"reset",this.addAll)},render:function(){return this.addAll(),this},addAll:function(){var c=this;a(this.el).html(""),b.each(this.collection.models,function(a){c.addComment(a)})},addComment:function(b){var c=this.createView(e,{model:b}),d=c.render().el;a(d).hide(),a(this.el).append(d),a(d).fadeIn(200)}});return f}),define("text!templates/comments/CommentForm.html",[],function(){return'<div class="row comment written">\n  <div class="ten columns offset-by-two commentBody shadow paper clearfix">\n    <span class="tape"></span>\n\n    <!-- Comment Avatar -->\n    <div class="commentAvatar">\n      <span class="miniAvatar"><img src="{{avatar}}" alt="{{name}}"></span>\n    </div>\n\n    <!-- Comment Body -->\n    <div class="commentInfo">\n\n      <!-- Form -->\n      <form action="#">\n        <div class="outerWrap">\n          <textarea class="placeholder written" name="ticket_comment" placeholder="Enter your comment..."></textarea>\n        </div>\n      </form>\n\n    </div>\n  </div>\n</div>'}),define("views/comments/CommentFormView",["jquery","underscore","backbone","BaseView","mustache","text!templates/comments/CommentForm.html"],function(a,b,c,d,e,f){var g=d.extend({events:{"keypress textarea":"createOnEnter"},initialize:function(){b.bindAll(this)},render:function(){return a(this.el).html(Mustache.to_html(f,ticketer.currentUser)),this.input=this.$("form textarea"),this},createOnEnter:function(a){if(a.keyCode!=13)return;if(a.keyCode===13&&!a.ctrlKey){a.preventDefault();var b=this;this.collection.create({comment:this.input.val()},{error:b.triggerViewError}),this.input.val("").blur(),this.input.css("height","23px")}},bindResize:function(){a("textarea",this.el).autoResize({minHeight:23,extraSpace:14})},triggerViewError:function(a,b){this.trigger("view:error",b)}});return g}),define("views/tickets/TicketDetailsView",["jquery","underscore","backbone","BaseView","views/tickets/TicketView","views/comments/CommentListView","views/comments/CommentFormView"],function(a,b,c,d,e,f,g){var h=d.extend({initialize:function(){b.bindAll(this)},render:function(){return this.renderTicket(),this.renderComments(),this.renderCommentForm(),this},renderTicket:function(){var b=this,c=this.createView(e,{model:this.model,admin:!0});this.bindTo(c,"view:error",function(a){b.trigger("view:error",a)}),a(this.el).html(c.render().el)},renderComments:function(){var b=this.createView(f,{collection:this.model.comments});a(this.el).append(b.render().el)},renderCommentForm:function(){var b=this,c=this.createView(g,{collection:b.model.comments});this.bindTo(this,"viewRendered",c.bindResize),this.bindTo(c,"view:error",function(a){b.trigger("view:error",a)}),a(this.el).append(c.render().el)}});return h}),define("text!templates/tickets/TicketForm.html",[],function(){return'<!-- Ticket Creator\'s Avatar -->\n<div class="two columns offset-by-one avatar clearfix">\n  <a class="right shadow paper" href="#">\n    <span class="tape"></span>\n    <img src="{{avatar}}" alt="{{name}}">\n    <span class="written">{{shortname}}</span>\n  </a>\n</div>\n\n<!-- Ticket Form -->\n<div class="eight columns ticketInfo shadow paper">\n  <span class="tack"></span>\n  <div id="ticketForm">\n    <form action="#" class="clearfix">\n      <div class="seperator">\n        <input type="text" name="title" class="written" placeholder="Ticket Name...">\n      </div>\n      <div class="outerWrap">\n        <textarea name="description" class="written" placeholder="Enter a description of your ticket..."></textarea>\n      </div>\n      <button class="right written green">Create Ticket</button>\n    </form>\n  </div>\n</div> <!-- end of Ticket Form -->'}),function(a){function d(b){return this.filter(d.resizableFilterSelector).each(function(){new e(a(this),b)}),this}function e(b,c){b.data("AutoResizer")&&b.data("AutoResizer").destroy(),c=this.config=a.extend({},d.defaults,c),this.el=b,this.nodeName=b[0].nodeName.toLowerCase(),this.originalHeight=b.height(),this.previousScrollTop=null,this.value=b.val(),c.maxWidth==="original"&&(c.maxWidth=b.width()),c.minWidth==="original"&&(c.minWidth=b.width()),c.maxHeight==="original"&&(c.maxHeight=b.height()),c.minHeight==="original"&&(c.minHeight=b.height()),this.nodeName==="textarea"&&b.css({resize:"none",overflowY:"hidden"}),b.data("AutoResizer",this),c.animate.complete=function(a){return function(){return c.onAfterResize.call(b),a.apply(this,arguments)}}(c.animate.complete),this.bind()}var b="ar"+ +(new Date),c=d.defaults={onResize:function(){},onBeforeResize:function(){return 123},onAfterResize:function(){return 555},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};d.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","paddingTop","paddingLeft","paddingBottom","paddingRight","width"],d.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden"},d.resizableFilterSelector=["textarea:not(textarea."+b+")","input:not(input[type])","input[type=text]","input[type=password]","input[type=email]","input[type=url]"].join(","),d.AutoResizer=e,a.fn.autoResize=d,e.prototype={bind:function(){var b=a.proxy(function(){return this.check(),!0},this);this.unbind(),this.el.bind("keyup.autoResize",b).bind("change.autoResize",b).bind("paste.autoResize",function(){setTimeout(function(){b()},0)}),this.el.is(":hidden")||this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var c=this.el,e=this.nodeName==="textarea"?c.clone():a("<span/>");this.clone=e,a.each(d.cloneCSSProperties,function(a,b){e[0].style[b]=c.css(b)}),e.removeAttr("name").removeAttr("id").addClass(b).attr("tabIndex",-1).css(d.cloneCSSValues),this.nodeName==="textarea"?e.height("auto"):e.width("auto").css({whiteSpace:"nowrap"})},check:function(a,b){this.clone||(this.createClone(),this.injectClone());var c=this.config,d=this.clone,e=this.el,f=e.val();if(f===this.prevValue)return!0;this.prevValue=f;if(this.nodeName==="input"){d.text(f);var g=d.width(),h=g+c.extraSpace>=c.minWidth?g+c.extraSpace:c.minWidth,i=e.width();h=Math.min(h,c.maxWidth);if(h<i&&h>=c.minWidth||h>=c.minWidth&&h<=c.maxWidth)c.onBeforeResize.call(e),c.onResize.call(e),e.scrollLeft(0),c.animate&&!b?e.stop(1,1).animate({width:h},c.animate):(e.width(h),c.onAfterResize.call(e));return}d.width(e.width()).height(0).val(f).scrollTop(1e4);var j=d[0].scrollTop;if(this.previousScrollTop===j)return;this.previousScrollTop=j,j+c.extraSpace>=c.maxHeight?(e.css("overflowY",""),j=c.maxHeight,b=!0):j<=c.minHeight?j=c.minHeight:(e.css("overflowY","hidden"),j+=c.extraSpace),c.onBeforeResize.call(e),c.onResize.call(e),c.animate&&!b?e.stop(1,1).animate({height:j},c.animate):(e.height(j),c.onAfterResize.call(e))},destroy:function(){this.unbind(),this.el.removeData("AutoResizer"),this.clone.remove(),delete this.el,delete this.clone},injectClone:function(){(d.cloneContainer||(d.cloneContainer=a("<arclones/>").appendTo("body"))).append(this.clone)}}}(jQuery),define("autoresize",function(){}),define("views/tickets/TicketFormView",["jquery","underscore","backbone","BaseView","mustache","text!templates/tickets/TicketForm.html","autoresize"],function(a,b,c,d,e,f){var g=d.extend({tagName:"div",className:"row ticket",events:{"click button":"createTicket"},initialize:function(){b.bindAll(this),this.bindTo(this.collection,"add",this.redirect)},render:function(){var b;return b=currentUser,b.shortname=b.name.split(" ")[0],a(this.el).html(Mustache.to_html(f,currentUser)),this.bindTo(this,"viewRendered",this.bindResize),this},createTicket:function(b){b.preventDefault();var c=this,d=a("[name=title]",this.el).val(),e=a("[name=description]",this.el).val();this.collection.create({title:d,description:e},{error:c.triggerViewError})},bindResize:function(){a("textarea",this.el).autoResize({minHeight:150,extraSpace:14})},redirect:function(a){window.history.replaceState({},document.title,"#tickets/open"),ticketer.routers.ticketer.navigate("tickets/"+a.id,!0)},triggerViewError:function(a,b){this.trigger("view:error",b)}});return g}),define("text!templates/errors/Error.html",[],function(){return'<div class="alert-message error">\n  <a class="close" href="#">x</a>\n  <p>{{error}}</p>\n</div>'}),define("views/errors/ErrorView",["jquery","underscore","backbone","BaseView","mustache","text!templates/errors/Error.html"],function(a,b,c,d,e,f){var g=d.extend({id:"error",tagName:"div",events:{"click .close":"closeError"},initialize:function(){b.bindAll(this),this.message=this.options.message},render:function(){return a(this.el).html(Mustache.to_html(f,{error:this.message})),this},closeError:function(b){b.preventDefault();var c=this;a(this.el).slideUp(200,"swing",function(){c.remove()})}});return g}),define("routers/Ticketer",["backbone","AppView","models/Ticket","views/tickets/TicketListView","views/tickets/TicketDetailsView","views/tickets/TicketFormView","views/errors/ErrorView"],function(a,b,c,d,e,f,g){var h=a.Router.extend({routes:{"":"index","tickets/open":"openTickets","tickets/open?*params":"openTickets","tickets/closed":"closedTickets","tickets/closed?*params":"closedTickets","tickets/mine":"myTickets","tickets/mine?*params":"myTickets","tickets/new":"createTicket","tickets/:id":"details"},initialize:function(){this.appView=new b},index:function(){this.navigate("tickets/open",!0)},openTickets:function(){var a=ticketer.views.headers.main,b=ticketer.collections.openTickets.models,c=new d({models:b});this.appView.showHeader(a,{tab:"openTickets"}),this.appView.showView(c)},closedTickets:function(){var a,b,c,e,f;a=this,b=ticketer.views.headers.main,c=ticketer.collections.closedTickets,this.appView.showHeader(b,{tab:"closedTickets"}),c.length<1?c.fetch({data:{page:1,status:"closed"},success:function(b,c){e=b.models,f=new d({collection:b,models:e,status:"closed"}),a.appView.showView(f)}}):(e=c.models,f=new d({collection:c,models:e,status:"closed"}),a.appView.showView(f))},myTickets:function(){var a=ticketer.views.headers.main,b=ticketer.collections.openTickets.mine,c=new d({models:b});this.appView.showHeader(a,{tab:"myTickets"}),this.appView.showView(c)},details:function(a){var b=this,d,e=ticketer.collections.openTickets.get(a)||ticketer.collections.closedTickets.get(a);typeof e=="undefined"?(e=new c({id:a}),e.fetch({success:function(a,c){a.comments.fetch(),b.displayView(e)}})):this.displayView(e)},createTicket:function(){var a=ticketer.views.headers.back,b=ticketer.collections.openTickets,c=new f({collection:b});c.bind("view:error",this.displayError,this),this.appView.showHeader(a),this.appView.showView(c,function(){c.trigger("viewRendered")})},displayError:function(a){this.appView.showError(g,a)},displayView:function(a){var b=ticketer.views.headers.back,c=new e({model:a});c.bind("view:error",this.displayError,this),this.appView.showHeader(b,{status:a.get("status")}),this.appView.showView(c,function(){c.trigger("viewRendered")})}});return h}),define("text!templates/headers/MainHeader.html",[],function(){return'<nav class="clearfix">\n  <ul class="left marker">\n    <li id="createTicket" class="green shadow">Create Ticket</li>\n    {{#showAdmin}}\n    <li class="pullTab shadow">\n      <ul id="assignees" class="scroll clearfix">\n        <!-- Append Admins Here -->\n      </ul>\n      <ul class="clearfix">\n        <li class="tab">Assign Ticket</li>\n      </ul>\n    </li>\n    {{/showAdmin}}\n  </ul>\n\n  <ul class="right marker">\n    {{#showAdmin}}\n    <li id="myTickets" class="shadow">My Tickets</li>\n    {{/showAdmin}}\n    <li id="openTickets" class="shadow">Open Tickets</li>\n    <li id="closedTickets" class="shadow">Closed Tickets</li>\n  </ul>\n</nav>'}),define("text!templates/headers/AssignPullTab.html",[],function(){return'<li class="assign clearfix" id="{{id}}">\n  <span class="name">{{shortname}}</span>\n  <span class="miniAvatar"><img src="{{avatar}}" alt="{{name}}"></span>\n</li>'}),function(a,b,c){function d(d,e){function h(b){a(f).each(function(){var c=a(this);this!==b.target&&!c.has(b.target).length&&c.triggerHandler(e,[b.target])})}e=e||d+c;var f=a(),g=d+"."+e+"-special-event";a.event.special[e]={setup:function(){f=f.add(this),f.length===1&&a(b).bind(g,h)},teardown:function(){f=f.not(this),f.length===0&&a(b).unbind(g)},add:function(a){var b=a.handler;a.handler=function(a,c){a.target=c,b.apply(this,arguments)}}}}a.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),function(a){d(a)}),d("focusin","focus"+c),d("focusout","blur"+c),a.addOutsideEvent=d}(jQuery,document,"outside"),define("outsideEvents",function(){}),define("views/headers/MainHeaderView",["jquery","underscore","backbone","BaseView","mustache","text!templates/headers/MainHeader.html","text!templates/headers/AssignPullTab.html","outsideEvents","jqueryui/draggable"],function(a,b,c,d,e,f,g){var h=d.extend({className:"row",tagName:"header",events:{"click #createTicket":"navigateToForm","click #myTickets":"toggleMyTickets","click #openTickets":"toggleOpen","click #closedTickets":"toggleClosed"},initialize:function(){b.bindAll(this)},render:function(){var b={};return b.showAdmin=this.renderAdminOptions(),a(this.el).html(Mustache.to_html(f,b)),b.showAdmin&&this.renderAssignees(),this},renderAdminOptions:function(){return ticketer.currentUser.role==="admin"?!0:!1},renderAssignees:function(){var c=this,d=ticketer.collections.admins;b.each(d.models,function(b){var d=b.toJSON();d.shortname=d.name.split(" ")[0],a("ul#assignees",c.el).append(Mustache.to_html(g,d))}),a("ul#assignees li",this.el).draggable({revert:!0,helper:"clone",scope:"assigned_to",zIndex:302,cursorAt:{top:28,left:69}}),this.bindTo(a(".pullTab .tab",this.el),"click",this.togglePullTab),this.bindTo(a(".pullTab",this.el),"clickoutside",this.hidePullTab)},navigateToForm:function(){ticketer.routers.ticketer.navigate("tickets/new",!0)},toggleMyTickets:function(){ticketer.routers.ticketer.navigate("tickets/mine",!0)},toggleOpen:function(){ticketer.routers.ticketer.navigate("tickets/open",!0)},toggleClosed:function(){ticketer.routers.ticketer.navigate("tickets/closed",!0)},toggleTab:function(b){a("#"+b+" .yellow","header").length===0&&(a("li",this.el).removeClass("yellow"),a("#"+b,this.el).addClass("yellow"))},toggleAssign:function(b){var c=this;b==="closedTickets"?a(".pullTab",c.el).css("display")!="none"&&a(".pullTab",c.el).hide():a(".pullTab",c.el).css("display")=="none"&&a(".pullTab",c.el).fadeIn(200)},togglePullTab:function(b){var c=a(b.currentTarget).closest(".pullTab"),d=a(".scroll",c);a(d).is(":hidden")?this.showPullTab(b):this.hidePullTab(b)},showPullTab:function(b){var c=a(b.currentTarget).closest(".pullTab"),d=a(".scroll",c);a(d).is(":hidden")&&(a(c).removeClass("shadow").addClass("lightShadow"),a(d).slideDown(200))},hidePullTab:function(b){var c=a(b.currentTarget).closest(".pullTab"),d=a(".scroll",c);a(d).is(":visible")&&a(d).slideUp(200,function(){a(c).removeClass("lightShadow").addClass("shadow")})}});return h}),define("text!templates/headers/Back.html",[],function(){return'<nav class="clearfix">\n  <ul class="left marker">\n    <li id="back" class="green shadow">Back</li>\n    {{#showAdmin}}\n    <li class="pullTab shadow">\n      <ul id="assignees" class="scroll clearfix">\n        <!-- Append Admins Here -->\n      </ul>\n      <ul class="clearfix">\n        <li class="tab">Assign Ticket</li>\n      </ul>\n    </li>\n    {{/showAdmin}}\n  </ul>\n</nav>'}),define("views/headers/BackHeaderView",["jquery","underscore","backbone","BaseView","text!templates/headers/Back.html","text!templates/headers/AssignPullTab.html","outsideEvents","jqueryui/draggable"],function(a,b,c,d,e,f){var g=d.extend({className:"row",tagName:"header",events:{"click li#back":"navigateBack"},initialize:function(){b.bindAll(this)},render:function(){var b={};return b.showAdmin=this.renderAdminOptions(),a(this.el).html(Mustache.to_html(e,b)),b.showAdmin&&this.renderAssignees(),this},navigateBack:function(a){a.preventDefault(),window.history.back()},renderAdminOptions:function(){return ticketer.currentUser.role==="admin"?!0:!1},renderAssignees:function(){var c=this,d=ticketer.collections.admins;b.each(d.models,function(b){var d=b.toJSON();d.shortname=d.name.split(" ")[0],a("ul#assignees",c.el).append(Mustache.to_html(f,d))}),a("ul#assignees li",this.el).draggable({revert:!0,helper:"clone",scope:"assigned_to",zIndex:302,cursorAt:{top:28,left:69}}),this.bindTo(a(".pullTab .tab",this.el),"click",this.togglePullTab),this.bindTo(a(".pullTab",this.el),"clickoutside",this.hidePullTab)},toggleAssign:function(b){var c=this;b==="closed"?a(".pullTab",c.el).hide():a(".pullTab",c.el).css("display")=="none"&&a(".pullTab",c.el).fadeIn(200)},togglePullTab:function(b){var c=a(b.currentTarget).closest(".pullTab"),d=a(".scroll",c);a(d).is(":hidden")?this.showPullTab(b):this.hidePullTab(b)},showPullTab:function(b){var c=a(b.currentTarget).closest(".pullTab"),d=a(".scroll",c);a(d).is(":hidden")&&(a(c).removeClass("shadow").addClass("lightShadow"),a(d).slideDown(200))},hidePullTab:function(b){var c=a(b.currentTarget).closest(".pullTab"),d=a(".scroll",c);a(d).is(":visible")&&a(d).slideUp(200,function(){a(c).removeClass("lightShadow").addClass("shadow")})}});return g}),define("app",["underscore","backbone","collections/Tickets","collections/Comments","collections/Users","routers/Ticketer","views/headers/MainHeaderView","views/headers/BackHeaderView"],function(a,b,c,d,e,f,g,h){$(function(){b.sync_model=b.sync,b.sync=function(c,d,e){var f=a.extend({beforeSend:function(a){var b=$('meta[name="X-Auth-Token"]').attr("content");b&&a.setRequestHeader("X-Auth-Token",b),a.setRequestHeader("Accept","application/json")}},e);b.sync_model(c,d,f)},window.ticketer=window.ticketer||{currentUser:currentUser,routers:{ticketer:new f},collections:{openTickets:new c,closedTickets:new c,admins:new e},views:{headers:{main:g,back:h}}},ticketer.currentUser.avatar||(ticketer.currentUser.avatar="/img/avatars/65x65.gif"),ticketer.collections.closedTickets.comparator=function(a){var b=new Date(a.get("closed_at")),c=b.getTime();return-c},ticketer.collections.openTickets.reset(tickets),ticketer.collections.admins.reset(admins),b.history.start()})}),require.config({baseUrl:"js",paths:{backbone:"libs/AMDbackbone-0.5.3",underscore:"libs/underscore",text:"libs/require/text",mustache:"libs/mustache",marked:"libs/marked",timeago:"libs/plugins/jquery.timeago",truncate:"libs/plugins/jquery.truncator",outsideEvents:"libs/plugins/jquery.ba-outside-events.min",autoresize:"libs/plugins/jquery.autoresize",jqueryui:"libs/jqueryui-1.8.16",timeline:"libs/timeline",BaseView:"support/GarbageCollector",AppView:"support/AppView"}}),require(["jquery","underscore","backbone","BaseView"],function(a,b,c,d){require(["app"],function(){})}),define("main",function(){})